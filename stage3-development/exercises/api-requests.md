# APIリクエスト実装演習

## 目的

この演習では、Pythonを使用してAI APIへのリクエストを実装し、エラーハンドリングやリトライ機能、非同期処理などの実践的なテクニックを学びます。

## 準備

1. 必要なライブラリをインストールしてください
   ```
   pip install requests aiohttp python-dotenv
   ```
2. `.env`ファイルを作成し、APIキーを設定してください
   ```
   OPENAI_API_KEY=your_openai_api_key
   GOOGLE_AI_API_KEY=your_google_ai_api_key
   ANTHROPIC_API_KEY=your_anthropic_api_key
   ```

## 演習1：基本的なAPIリクエスト

### 課題1-1：GETリクエストとPOSTリクエスト

`code-examples/api_requests.py`を参照し、以下の課題に取り組んでください：

1. 公開APIを使用してGETリクエストを実行し、結果を表示するプログラムを作成してください
   - 例：JSONPlaceholder API（https://jsonplaceholder.typicode.com/）
   - 取得したデータを整形して表示してください

2. 同じAPIに対してPOSTリクエストを実行し、新しいリソースを作成するプログラムを作成してください
   - リクエストボディにJSONデータを含めてください
   - レスポンスを適切に処理してください

### 課題1-2：エラーハンドリング

1. 存在しないエンドポイントにリクエストを送信し、発生するエラーを適切に処理するプログラムを作成してください
2. 以下のエラーケースを処理できるようにしてください：
   - HTTPエラー（400, 404, 500など）
   - 接続エラー
   - タイムアウト
   - JSONデコードエラー

## 演習2：AI APIへのリクエスト

### 課題2-1：OpenAI APIリクエスト

1. OpenAI APIを使用して、チャット完了エンドポイントにリクエストを送信するプログラムを作成してください
2. システムプロンプトとユーザープロンプトを設定し、法務関連の質問に回答を得てください
3. レスポンスから必要な情報を抽出して表示してください

### 課題2-2：複数のAI APIへのリクエスト

1. 同じプロンプトを使用して、OpenAI API、Google AI API、Anthropic APIにリクエストを送信するプログラムを作成してください
2. 各APIのレスポンスを比較できるように結果を表示してください
3. 応答時間やトークン使用量などのメトリクスも記録してください

## 演習3：高度なリクエスト処理

### 課題3-1：リトライ機能の実装

1. `api_request_with_retry`関数を参考に、独自のリトライ機能を持つAPIリクエスト関数を実装してください
2. 以下の機能を含めてください：
   - 指数バックオフによる待機時間の設定
   - 特定のエラーコード（429など）に対する特別な処理
   - 最大再試行回数の設定
   - 詳細なログ出力

3. 実装した関数を使用して、AI APIにリクエストを送信し、リトライ機能をテストしてください

### 課題3-2：非同期リクエストの実装

1. `asyncio`と`aiohttp`を使用して、複数のAPIリクエストを非同期に処理するプログラムを作成してください
2. 以下の機能を実装してください：
   - 複数のエンドポイントへの並行リクエスト
   - エラーハンドリングとタイムアウト設定
   - 結果の集約と表示

3. 同期処理と非同期処理の実行時間を比較し、パフォーマンスの違いを確認してください

## 演習4：実践的なAPIクライアントの開発

### 課題4-1：法務文書分析APIクライアント

1. 法務文書を分析するためのAPIクライアントクラスを設計・実装してください
2. 以下の機能を含めてください：
   - 文書のアップロードと分析リクエスト
   - 分析結果の取得と解析
   - エラーハンドリングとリトライ機能
   - 結果のキャッシュ機能

3. クライアントを使用して、サンプル契約書を分析し、結果を表示してください

### 課題4-2：バッチ処理とレート制限対応

1. 複数の文書を効率的に処理するためのバッチ処理機能を実装してください
2. APIのレート制限に対応するための機能を実装してください：
   - リクエスト間隔の調整
   - 429エラーの適切な処理
   - 使用量のモニタリングと制限

3. 実装したバッチ処理機能を使用して、複数の文書を処理し、結果をファイルに保存してください

## 提出課題

以上の演習を通じて学んだことを活かして、以下の課題に取り組んでください：

1. 法務業務に役立つAPIクライアントアプリケーションを設計・実装してください
   - 複数のAI APIを活用
   - エラーハンドリングとリトライ機能
   - 非同期処理による効率化
   - ユーザーフレンドリーなインターフェース

2. 以下の内容を含むレポートを作成してください（800〜1,200字程度）：
   - アプリケーションの目的と機能
   - 設計上の工夫点（アーキテクチャ、エラー処理など）
   - パフォーマンス最適化の手法
   - 実務での活用シナリオ
   - 今後の改善点

提出方法：研修用ポータルサイトの課題提出ページからソースコードとレポートをアップロードしてください。 