# ファインチューニング実践演習

## 目的

この演習では、生成AIモデルのファインチューニングを実践し、法務業務に特化したカスタムモデルを作成する方法を学びます。データの準備、モデルのトレーニング、評価、デプロイまでの一連のプロセスを習得することを目的としています。

## 準備

1. 必要なライブラリをインストールしてください
   ```
   pip install openai pandas scikit-learn python-dotenv
   ```

2. `.env`ファイルにAPIキーを設定してください
   ```
   OPENAI_API_KEY=your_openai_api_key
   ```

3. ファインチューニング用のデータを準備してください（法務関連の質問と回答のペアなど）

## 演習1：データの準備と前処理

### 課題1-1：トレーニングデータの作成

`code-examples/fine_tuning_prep.py`を参照し、以下の課題に取り組んでください：

1. 法務業務に関連する質問と回答のペアを少なくとも20組用意してください
   - 契約書に関する質問
   - 法律解釈に関する質問
   - リスク分析に関する質問
   - 実務上のアドバイスに関する質問

2. 用意したデータをOpenAIのファインチューニング形式（JSONL形式）に変換するプログラムを実装してください
   - 各データポイントには、システムメッセージ、ユーザーメッセージ、アシスタントメッセージを含めてください

3. データを訓練用と検証用に分割してください（例：80%訓練、20%検証）

### 課題1-2：データの品質チェックと改善

1. 以下の観点からデータの品質をチェックするプログラムを実装してください：
   - フォーマットの正確性
   - 内容の多様性
   - 回答の品質と一貫性
   - 特殊文字や不適切な内容の有無

2. 品質チェックの結果に基づいて、データを改善してください

3. データのトークン数を計算し、ファインチューニングのコストを見積もるプログラムを実装してください

## 演習2：モデルのファインチューニング

### 課題2-1：ファインチューニングジョブの作成

1. OpenAI APIを使用して、ファインチューニング用のデータをアップロードするプログラムを実装してください

2. ファインチューニングジョブを作成し、実行するプログラムを実装してください
   - 適切なベースモデル（例：gpt-3.5-turbo）を選択してください
   - ハイパーパラメータ（エポック数など）を設定してください

3. ファインチューニングの進捗を監視するプログラムを実装してください

### 課題2-2：モデルの評価

1. ファインチューニングされたモデルを使用して、検証用データセットに対する回答を生成するプログラムを実装してください

2. 以下の指標を使用して、モデルの性能を評価してください：
   - 回答の正確性
   - 回答の関連性
   - 回答のスタイルと一貫性
   - 専門知識の反映度

3. ベースモデル（ファインチューニング前）とファインチューニング後のモデルの性能を比較してください

## 演習3：モデルの改良と最適化

### 課題3-1：データの拡張と改良

1. 評価結果に基づいて、トレーニングデータを拡張・改良してください：
   - 弱点が見られた分野のデータを追加
   - 誤りや不一致を修正
   - より多様なケースを含める

2. 改良したデータを使用して、新しいファインチューニングジョブを作成してください

3. 改良前後のモデルの性能を比較してください

### 課題3-2：プロンプトエンジニアリングとの組み合わせ

1. ファインチューニングされたモデルの性能をさらに向上させるための効果的なプロンプトを設計してください

2. 以下の要素を組み合わせたハイブリッドアプローチを実装してください：
   - ファインチューニングされたモデル
   - 効果的なシステムプロンプト
   - 少数ショット学習（few-shot learning）
   - チェーン・オブ・ソート（chain-of-thought）

3. ハイブリッドアプローチの効果を評価してください

## 演習4：モデルのデプロイと活用

### 課題4-1：APIラッパーの作成

1. ファインチューニングされたモデルを簡単に利用できるAPIラッパークラスを実装してください：
   - モデルIDの管理
   - リクエストの構築
   - レスポンスの解析
   - エラーハンドリング

2. 以下の機能を追加してください：
   - 温度（temperature）などのパラメータ調整
   - コンテキスト管理（会話履歴の保持）
   - レスポンスのフォーマット指定

### 課題4-2：実務での活用

1. ファインチューニングされたモデルを活用した法務アシスタントアプリケーションを実装してください：
   - 契約書レビュー支援
   - 法的質問応答
   - リスク分析
   - 文書作成支援

2. アプリケーションのユーザーインターフェースを設計・実装してください（コマンドライン、Web、またはGUIなど）

3. アプリケーションのユーザーマニュアルを作成してください

## 提出課題

以上の演習を通じて学んだことを活かして、以下の課題に取り組んでください：

1. 法務業務に特化したカスタムAIモデルを作成してください：
   - 少なくとも30組の高品質なトレーニングデータ
   - 適切なファインチューニングパラメータ
   - 評価と最適化のプロセス

2. 作成したモデルを活用したアプリケーションを実装してください：
   - 特定の法務業務（契約書レビュー、法的アドバイスなど）に焦点を当てる
   - ユーザーフレンドリーなインターフェース
   - 実務での活用シナリオを想定した機能

3. 以下の内容を含むレポートを作成してください（800〜1,200字程度）：
   - モデル作成のプロセスと工夫点
   - 評価結果と改善の取り組み
   - アプリケーションの設計と実装の概要
   - 実務での活用シナリオと期待される効果
   - 今後の改善点と課題

4. モデルとアプリケーションのデモンストレーション動画（3分程度）を作成してください

提出方法：研修用ポータルサイトの課題提出ページからトレーニングデータ、ソースコード、レポート、デモ動画をアップロードしてください。 