<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLMのアーキテクチャと学習プロセス - 法務AIナビゲーター by LegalTorch</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="blog-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <img src="../../images/LegalTorch.jpg" alt="法務AIナビゲーター Logo">
            </div>
            <nav>
                <ul>
                    <li><a href="../../index.html">ホーム</a></li>
                    <li><a href="../../about.html">会社案内</a></li>
                    <li><a href="../../program.html">研修プログラム</a></li>
                    <li><a href="../../contact.html">お問い合わせ</a></li>
                </ul>
            </nav>
            <div class="menu-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </header>

    <section class="page-header">
        <div class="container">
            <h1>LLMのアーキテクチャと学習プロセス</h1>
            <div class="breadcrumbs">
                <a href="../../index.html">ホーム</a> &gt; 
                <a href="../../program.html">研修プログラム</a> &gt; 
                <a href="../index.html">第1段階：AI基礎研修</a> &gt; 
                <a href="../slides/1-3-llm-overview.html">LLMの概要と仕組み</a> &gt;
                <span>LLMのアーキテクチャと学習プロセス</span>
            </div>
        </div>
    </section>

    <section class="content-section">
        <div class="container">
            <div class="blog-content">
                <h2>LLMのアーキテクチャと学習プロセス</h2>
                
                <p>大規模言語モデル（LLM）の内部構造と、どのようにして膨大なテキストデータから言語を学習するのかについて解説します。LLMの中核となるTransformerアーキテクチャから、トークン化、学習プロセスまでを詳しく見ていきましょう。</p>
                
                <h3>Transformerアーキテクチャ</h3>
                
                <!-- SVG illustration of Transformer architecture -->
                <div class="svg-container">
                    <svg width="700" height="500" viewBox="0 0 700 500" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="bg-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#f5f7fa"/>
                                <stop offset="100%" stop-color="#c3cfe2"/>
                            </linearGradient>
                            <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                <path d="M0,0 L0,6 L9,3 z" fill="#34495e"/>
                            </marker>
                        </defs>
                        
                        <!-- Background -->
                        <rect width="700" height="500" fill="url(#bg-gradient)" rx="10" ry="10"/>
                        
                        <!-- Title -->
                        <text x="350" y="40" text-anchor="middle" font-family="Arial" font-size="24" font-weight="bold" fill="#2c3e50">Transformerアーキテクチャ</text>
                        
                        <!-- Input -->
                        <rect x="50" y="80" width="600" height="40" rx="5" ry="5" fill="#3498db" opacity="0.2" stroke="#3498db" stroke-width="2"/>
                        <text x="350" y="105" text-anchor="middle" font-family="Arial" font-size="16" fill="#2c3e50">入力テキスト</text>
                        
                        <!-- Tokenization -->
                        <rect x="50" y="140" width="600" height="40" rx="5" ry="5" fill="#9b59b6" opacity="0.2" stroke="#9b59b6" stroke-width="2"/>
                        <text x="350" y="165" text-anchor="middle" font-family="Arial" font-size="16" fill="#2c3e50">トークン化</text>
                        
                        <!-- Embedding -->
                        <rect x="50" y="200" width="600" height="40" rx="5" ry="5" fill="#e74c3c" opacity="0.2" stroke="#e74c3c" stroke-width="2"/>
                        <text x="350" y="225" text-anchor="middle" font-family="Arial" font-size="16" fill="#2c3e50">埋め込み（Embedding）</text>
                        
                        <!-- Self-Attention -->
                        <rect x="150" y="260" width="400" height="60" rx="5" ry="5" fill="#f39c12" opacity="0.2" stroke="#f39c12" stroke-width="2"/>
                        <text x="350" y="295" text-anchor="middle" font-family="Arial" font-size="16" fill="#2c3e50">セルフアテンション（Self-Attention）</text>
                        
                        <!-- Feed Forward -->
                        <rect x="150" y="340" width="400" height="40" rx="5" ry="5" fill="#2ecc71" opacity="0.2" stroke="#2ecc71" stroke-width="2"/>
                        <text x="350" y="365" text-anchor="middle" font-family="Arial" font-size="16" fill="#2c3e50">フィードフォワードネットワーク</text>
                        
                        <!-- Output -->
                        <rect x="50" y="400" width="600" height="40" rx="5" ry="5" fill="#3498db" opacity="0.2" stroke="#3498db" stroke-width="2"/>
                        <text x="350" y="425" text-anchor="middle" font-family="Arial" font-size="16" fill="#2c3e50">出力（次のトークン予測）</text>
                        
                        <!-- Arrows -->
                        <path d="M350,120 L350,140" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                        <path d="M350,180 L350,200" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                        <path d="M350,240 L350,260" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                        <path d="M350,320 L350,340" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                        <path d="M350,380 L350,400" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                    </svg>
                </div>
                
                <p>Transformerアーキテクチャは、2017年にGoogleの研究者たちによって発表された論文「Attention is All You Need」で提案された革新的なニューラルネットワーク構造です。このアーキテクチャは、現代のLLMの基盤となっており、以下のような特徴を持っています：</p>
                
                <ul>
                    <li><strong>並列処理能力</strong>：従来のRNN（再帰型ニューラルネットワーク）と異なり、シーケンス全体を一度に処理できるため、学習が高速</li>
                    <li><strong>長距離依存関係の捕捉</strong>：文章内の離れた位置にある単語間の関係性を効果的に捉えることが可能</li>
                    <li><strong>スケーラビリティ</strong>：モデルサイズを大きくすることで性能が向上する特性を持つ</li>
                </ul>
                
                <div class="highlight-box">
                    <h4>Transformerの革新性</h4>
                    <p>Transformerが革新的だった理由は、「アテンション機構」を中心に据えたことです。それまでの言語モデルは、RNNやLSTMといった順次処理型のアーキテクチャが主流でしたが、Transformerは並列処理と自己注意機構により、より効率的かつ効果的に言語を処理できるようになりました。</p>
                </div>
                
                <h3>トークン化（Tokenization）</h3>
                
                <p>LLMがテキストを処理する最初のステップは、入力テキストを「トークン」と呼ばれる小さな単位に分割することです。トークン化には以下のような特徴があります：</p>
                
                <ul>
                    <li><strong>トークンの種類</strong>：単語単位、部分単語（subword）単位、文字単位など様々な方式がある</li>
                    <li><strong>一般的な方式</strong>：現代のLLMでは、BPE（Byte-Pair Encoding）やWordPieceなどの部分単語トークン化が主流</li>
                    <li><strong>語彙サイズ</strong>：一般的なLLMでは数万～数十万のトークンを語彙として持つ</li>
                </ul>
                
                <div class="example-box">
                    <h4>トークン化の例</h4>
                    <p>例えば「こんにちは、世界」という日本語テキストは、トークン化によって以下のように分割される可能性があります：</p>
                    <ul>
                        <li>「こん」「にち」「は」「、」「世界」</li>
                    </ul>
                    <p>英語の場合、"Hello, world!"は以下のようになる可能性があります：</p>
                    <ul>
                        <li>「Hello」「,」「world」「!」</li>
                        <li>または「H」「ello」「,」「world」「!」など、使用するトークナイザーによって異なる</li>
                    </ul>
                </div>
                
                <h3>埋め込み（Embedding）</h3>
                
                <p>トークン化されたテキストは、次に「埋め込み」と呼ばれるプロセスで数値ベクトルに変換されます：</p>
                
                <ul>
                    <li><strong>トークン埋め込み</strong>：各トークンを固定次元の密ベクトルに変換</li>
                    <li><strong>位置埋め込み</strong>：トークンの位置情報を表すベクトルを追加（Transformerは位置情報を明示的に与える必要がある）</li>
                    <li><strong>次元</strong>：一般的なLLMでは数百～数千次元のベクトルを使用</li>
                </ul>
                
                <p>埋め込みベクトルは、トークンの意味的な特徴を数値空間で表現します。意味的に近い単語は、埋め込み空間でも近い位置に配置されます。</p>
                
                <h3>セルフアテンション（Self-Attention）</h3>
                
                <p>Transformerの中核となる機構が「セルフアテンション」です。これにより、入力シーケンス内の各トークンが他のすべてのトークンとの関連性を計算できます：</p>
                
                <!-- SVG illustration of Self-Attention -->
                <div class="svg-container">
                    <svg width="700" height="300" viewBox="0 0 700 300" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="attention-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#f5f7fa"/>
                                <stop offset="100%" stop-color="#c3cfe2"/>
                            </linearGradient>
                        </defs>
                        
                        <!-- Background -->
                        <rect width="700" height="300" fill="url(#attention-gradient)" rx="10" ry="10"/>
                        
                        <!-- Title -->
                        <text x="350" y="40" text-anchor="middle" font-family="Arial" font-size="20" font-weight="bold" fill="#2c3e50">セルフアテンション機構</text>
                        
                        <!-- Input tokens -->
                        <rect x="100" y="80" width="80" height="40" rx="5" ry="5" fill="#3498db" opacity="0.2" stroke="#3498db" stroke-width="2"/>
                        <text x="140" y="105" text-anchor="middle" font-family="Arial" font-size="14" fill="#2c3e50">トークン1</text>
                        
                        <rect x="200" y="80" width="80" height="40" rx="5" ry="5" fill="#3498db" opacity="0.2" stroke="#3498db" stroke-width="2"/>
                        <text x="240" y="105" text-anchor="middle" font-family="Arial" font-size="14" fill="#2c3e50">トークン2</text>
                        
                        <rect x="300" y="80" width="80" height="40" rx="5" ry="5" fill="#3498db" opacity="0.2" stroke="#3498db" stroke-width="2"/>
                        <text x="340" y="105" text-anchor="middle" font-family="Arial" font-size="14" fill="#2c3e50">トークン3</text>
                        
                        <rect x="400" y="80" width="80" height="40" rx="5" ry="5" fill="#3498db" opacity="0.2" stroke="#3498db" stroke-width="2"/>
                        <text x="440" y="105" text-anchor="middle" font-family="Arial" font-size="14" fill="#2c3e50">トークン4</text>
                        
                        <rect x="500" y="80" width="80" height="40" rx="5" ry="5" fill="#3498db" opacity="0.2" stroke="#3498db" stroke-width="2"/>
                        <text x="540" y="105" text-anchor="middle" font-family="Arial" font-size="14" fill="#2c3e50">トークン5</text>
                        
                        <!-- Attention weights -->
                        <path d="M140,120 C140,160 340,160 340,200" stroke="#e74c3c" stroke-width="3" fill="none" opacity="0.8"/>
                        <path d="M240,120 C240,150 340,150 340,200" stroke="#e74c3c" stroke-width="2" fill="none" opacity="0.5"/>
                        <path d="M340,120 C340,140 340,140 340,200" stroke="#e74c3c" stroke-width="4" fill="none" opacity="1.0"/>
                        <path d="M440,120 C440,150 340,150 340,200" stroke="#e74c3c" stroke-width="2" fill="none" opacity="0.5"/>
                        <path d="M540,120 C540,160 340,160 340,200" stroke="#e74c3c" stroke-width="1" fill="none" opacity="0.3"/>
                        
                        <!-- Output token -->
                        <rect x="300" y="200" width="80" height="40" rx="5" ry="5" fill="#2ecc71" opacity="0.2" stroke="#2ecc71" stroke-width="2"/>
                        <text x="340" y="225" text-anchor="middle" font-family="Arial" font-size="14" fill="#2c3e50">出力3</text>
                        
                        <!-- Legend -->
                        <rect x="50" y="260" width="20" height="5" fill="#e74c3c" opacity="1.0"/>
                        <text x="80" y="265" font-family="Arial" font-size="12" fill="#2c3e50">アテンションの強さ</text>
                    </svg>
                </div>
                
                <p>セルフアテンションの計算プロセスは以下のようになります：</p>
                
                <ol>
                    <li><strong>クエリ（Q）、キー（K）、バリュー（V）の生成</strong>：各トークンの埋め込みから、3種類の異なるベクトル（Q、K、V）を生成</li>
                    <li><strong>アテンションスコアの計算</strong>：各トークンのクエリ（Q）と他のすべてのトークンのキー（K）の内積を計算し、スケーリングと正規化を適用</li>
                    <li><strong>加重和の計算</strong>：アテンションスコアを重みとして、バリュー（V）ベクトルの加重和を計算</li>
                </ol>
                
                <div class="highlight-box">
                    <h4>マルチヘッドアテンション</h4>
                    <p>実際のTransformerでは、「マルチヘッドアテンション」と呼ばれる拡張版が使用されます。これは複数のアテンション機構（ヘッド）を並列に実行し、それぞれが異なる特徴に注目できるようにするものです。例えば、あるヘッドは文法的関係に、別のヘッドは意味的関係に注目するといった具合です。</p>
                </div>
                
                <h3>フィードフォワードネットワーク</h3>
                
                <p>セルフアテンションの出力は、次に全結合のフィードフォワードネットワークに渡されます：</p>
                
                <ul>
                    <li><strong>構造</strong>：通常、2層の全結合層で構成</li>
                    <li><strong>活性化関数</strong>：一般的にはReLUやGELUなどの非線形活性化関数を使用</li>
                    <li><strong>役割</strong>：トークン表現をさらに変換し、より豊かな特徴表現を獲得</li>
                </ul>
                
                <p>このフィードフォワードネットワークは、各トークンに対して独立に適用されます。</p>
                
                <h3>LLMの学習プロセス</h3>
                
                <h4>1. 事前学習（Pre-training）</h4>
                
                <p>LLMの学習は、まず「事前学習」と呼ばれる段階から始まります：</p>
                
                <ul>
                    <li><strong>データ</strong>：インターネット上の膨大なテキストデータ（数百GB～数TB）を使用</li>
                    <li><strong>学習タスク</strong>：主に「次のトークン予測」（言語モデリング）タスクを使用</li>
                    <li><strong>計算リソース</strong>：数百～数千のGPUを数週間～数ヶ月使用</li>
                    <li><strong>目的</strong>：言語の統計的パターンと世界知識を獲得</li>
                </ul>
                
                <div class="example-box">
                    <h4>事前学習の規模</h4>
                    <p>GPT-3の事前学習では、約45TBのテキストデータ（約1兆トークン）を使用し、数千のGPUで数ヶ月かけて学習が行われました。この膨大な計算コストは、LLM開発の大きな障壁の一つとなっています。</p>
                </div>
                
                <h4>2. 微調整（Fine-tuning）</h4>
                
                <p>事前学習の後、特定の用途に合わせて「微調整」が行われます：</p>
                
                <ul>
                    <li><strong>データ</strong>：特定のタスクや用途に関連する高品質なデータセット</li>
                    <li><strong>学習方法</strong>：教師あり学習や強化学習を使用</li>
                    <li><strong>RLHF</strong>：人間のフィードバックによる強化学習（Reinforcement Learning from Human Feedback）が重要な役割</li>
                    <li><strong>目的</strong>：特定のタスクでの性能向上、安全性・有用性の向上</li>
                </ul>
                
                <p>微調整により、事前学習だけでは達成できない特定の能力や特性を獲得することができます。</p>
                
                <h3>法務分野でのTransformerアーキテクチャの意義</h3>
                
                <p>Transformerアーキテクチャは、法務分野のAI応用において以下のような意義を持ちます：</p>
                
                <ul>
                    <li><strong>長文理解能力</strong>：法律文書は長文が多いため、長距離依存関係を捉えられるTransformerの特性が有用</li>
                    <li><strong>文脈理解</strong>：法的文書の解釈には文脈理解が不可欠であり、セルフアテンション機構がこれを可能に</li>
                    <li><strong>専門用語の処理</strong>：法律特有の専門用語や表現を適切に処理できる</li>
                </ul>
                
                <p>これらの特性により、Transformerベースのモデルは、契約書分析、判例検索、法的文書生成など、様々な法務タスクで高い性能を発揮します。</p>
                
                <div class="blog-navigation">
                    <a href="llm-basics.html"><i class="fas fa-arrow-left"></i> LLMの基礎</a>
                    <a href="llm-capabilities.html">LLMの能力と法務応用 <i class="fas fa-arrow-right"></i></a>
                </div>
            </div>
        </div>
    </section>

<!-- Topic-based navigation -->
<div class="blog-topics">
    <h3>トピック別ブログ記事</h3>
    <p>他のトピックの記事も読む：</p>
    <ul>
        <li><a href="index.html#ai-basics">AI基礎</a></li>
        <li><a href="index.html#machine-learning">機械学習</a></li>
        <li><a href="index.html#llm">大規模言語モデル</a></li>
        <li><a href="index.html#prompt-engineering">プロンプトエンジニアリング</a></li>
        <li><a href="index.html#ai-services">AIサービス</a></li>
        <li><a href="index.html#legal-ai-cases">法務AI活用事例</a></li>
        <li><a href="index.html#ai-ethics">AI倫理と法的課題</a></li>
    </ul>
</div>

<!-- Previous/Next navigation -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="../../images/LegalTorch.jpg" alt="法務AIナビゲーター Logo">
                    <p>法務業務の未来を照らす</p>
                </div>
                <div class="footer-links">
                    <h4>リンク</h4>
                    <ul>
                        <li><a href="../../index.html">ホーム</a></li>
                        <li><a href="../../about.html">会社案内</a></li>
                        <li><a href="../../program.html">研修プログラム</a></li>
                        <li><a href="../../contact.html">お問い合わせ</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h4>お問い合わせ</h4>
                    <p>〒170-6033<br>東京都豊島区東池袋3-1-1<br>サンシャイン60</p>
                    <p>TEL: 03-1234-5678<br>Email: info@legaltorch.co.jp</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 法務AIナビゲーター by LegalTorch All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../../js/main.js"></script>
</body>
</html>
